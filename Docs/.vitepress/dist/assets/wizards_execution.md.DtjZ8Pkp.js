import{_ as i,c as e,o as a,ae as t}from"./chunks/framework.CM88uqJ3.js";const n="/PoshUI/assets/Live-Execution-Console.BfgovU6S.png",u=JSON.parse('{"title":"Execution & ScriptBody","description":"","frontmatter":{},"headers":[],"relativePath":"wizards/execution.md","filePath":"wizards/execution.md"}'),l={name:"wizards/execution.md"};function o(r,s,h,p,d,c){return a(),e("div",null,[...s[0]||(s[0]=[t(`<h1 id="execution-scriptbody" tabindex="-1">Execution &amp; ScriptBody <a class="header-anchor" href="#execution-scriptbody" aria-label="Permalink to &quot;Execution &amp; ScriptBody&quot;">​</a></h1><p>PoshUI Wizards support two primary execution patterns: Simple Mode (data collection) and Live Execution Mode (real-time automation).</p><h2 id="simple-mode-data-collection" tabindex="-1">Simple Mode (Data Collection) <a class="header-anchor" href="#simple-mode-data-collection" aria-label="Permalink to &quot;Simple Mode (Data Collection)&quot;">​</a></h2><p>In Simple Mode, the wizard is used solely to collect information from the user. Once the user clicks <strong>Finish</strong>, the wizard closes and returns a hashtable containing all the values entered.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Show the wizard and capture the result</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Show-PoshUIWizard</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check if user cancelled (returns $null)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $result) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Write-Warning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;User cancelled the wizard.&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Access the collected values</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Deploying to server: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$result.ServerName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre></div><h2 id="live-execution-mode-scriptbody" tabindex="-1">Live Execution Mode (ScriptBody) <a class="header-anchor" href="#live-execution-mode-scriptbody" aria-label="Permalink to &quot;Live Execution Mode (ScriptBody)&quot;">​</a></h2><p>Live Execution Mode allows you to run your automation logic <em>inside</em> the wizard interface. When the user clicks <strong>Finish</strong>, the wizard transitions to an execution console where they can see your script running in real-time.</p><p><img src="`+n+`" alt="Live Execution Console"></p><h3 id="using-the-scriptbody-parameter" tabindex="-1">Using the -ScriptBody Parameter <a class="header-anchor" href="#using-the-scriptbody-parameter" aria-label="Permalink to &quot;Using the -ScriptBody Parameter&quot;">​</a></h3><p>Pass a ScriptBlock to the <code>-ScriptBody</code> parameter of <code>Show-PoshUIWizard</code>.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Show-PoshUIWizard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBody {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # All wizard controls are available as variables</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Starting deployment for </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ServerName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ForegroundColor Cyan</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Perform long-running tasks</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">..</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ForEach-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Configuring component </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Start-Sleep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Seconds </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Deployment Completed Successfully!&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ForegroundColor Green</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="key-features-of-live-execution" tabindex="-1">Key Features of Live Execution <a class="header-anchor" href="#key-features-of-live-execution" aria-label="Permalink to &quot;Key Features of Live Execution&quot;">​</a></h3><ul><li><strong>Real-Time Streaming</strong>: <code>Write-Host</code>, <code>Write-Output</code>, and <code>Write-Progress</code> are streamed directly to the UI console.</li><li><strong>Variable Injection</strong>: Every control you added to the wizard (e.g., <code>-Name &#39;ServerName&#39;</code>) is automatically injected into the script body as a local variable (<code>$ServerName</code>).</li><li><strong>Error Handling</strong>: If your script throws an error, it is displayed in the console, and the &quot;Finish&quot; button becomes a &quot;Close&quot; button.</li></ul><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Do NOT check the <code>$result</code> after using <code>-ScriptBody</code>. In Live Execution Mode, the work is already done by the time the wizard returns. The return value only indicates if the window was closed gracefully.</p></div><h2 id="execution-context" tabindex="-1">Execution Context <a class="header-anchor" href="#execution-context" aria-label="Permalink to &quot;Execution Context&quot;">​</a></h2><p>The script runs in an isolated PowerShell session managed by the PoshUI executable. This ensures that:</p><ol><li>Long-running tasks don&#39;t hang the UI thread.</li><li>Environment variables and session state are preserved for the duration of the execution.</li><li>Proper cleanup is performed when the window is closed.</li></ol><p>Next: <a href="./results.html">Handling Results</a></p>`,18)])])}const g=i(l,[["render",o]]);export{u as __pageData,g as default};
