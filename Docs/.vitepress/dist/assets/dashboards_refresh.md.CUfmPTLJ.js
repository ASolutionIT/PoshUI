import{_ as i,c as a,o as e,ae as t}from"./chunks/framework.CM88uqJ3.js";const c=JSON.parse('{"title":"Live Refresh","description":"","frontmatter":{},"headers":[],"relativePath":"dashboards/refresh.md","filePath":"dashboards/refresh.md"}'),h={name:"dashboards/refresh.md"};function r(n,s,l,p,k,d){return e(),a("div",null,[...s[0]||(s[0]=[t('<h1 id="live-refresh" tabindex="-1">Live Refresh <a class="header-anchor" href="#live-refresh" aria-label="Permalink to &quot;Live Refresh&quot;">​</a></h1><p>Dashboards in PoshUI support real-time updates for visualization cards. This allows you to monitor dynamic data like system performance, active processes, or service status without manual interaction.</p><h2 id="how-refresh-works" tabindex="-1">How Refresh Works <a class="header-anchor" href="#how-refresh-works" aria-label="Permalink to &quot;How Refresh Works&quot;">​</a></h2><p>Each card in a dashboard can have its own <code>-RefreshScript</code> and <code>-RefreshInterval</code>.</p><ol><li><strong>Initial Load</strong>: When the dashboard starts, the <code>Value</code> or <code>Data</code> script is executed once.</li><li><strong>Scheduling</strong>: The card enters a refresh loop based on the <code>RefreshInterval</code> (in seconds).</li><li><strong>Execution</strong>: The <code>RefreshScript</code> is executed in a background runspace.</li><li><strong>UI Update</strong>: The result of the script is pushed to the UI, and the card updates its display.</li></ol><h2 id="configuring-refresh" tabindex="-1">Configuring Refresh <a class="header-anchor" href="#configuring-refresh" aria-label="Permalink to &quot;Configuring Refresh&quot;">​</a></h2><h3 id="simple-metric-refresh" tabindex="-1">Simple Metric Refresh <a class="header-anchor" href="#simple-metric-refresh" aria-label="Permalink to &quot;Simple Metric Refresh&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIVisualizationCard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Main&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;CPU&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type MetricCard </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;CPU Usage&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> `</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Value </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> `</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Unit </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> `</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RefreshScript { (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-CimInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Win32_Processor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Measure-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LoadPercentage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Average).Average } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RefreshInterval </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span></code></pre></div><h3 id="datagrid-refresh" tabindex="-1">DataGrid Refresh <a class="header-anchor" href="#datagrid-refresh" aria-label="Permalink to &quot;DataGrid Refresh&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIVisualizationCard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Main&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ProcGrid&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type DataGridCard </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Top Processes&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> `</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RefreshScript { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-Process</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Sort-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CPU </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Descending </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Select-Object</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">First </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CPU } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">`</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RefreshInterval </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span></code></pre></div><h2 id="refresh-properties" tabindex="-1">Refresh Properties <a class="header-anchor" href="#refresh-properties" aria-label="Permalink to &quot;Refresh Properties&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>-RefreshScript</code></td><td>A ScriptBlock that returns the new value/data for the card.</td></tr><tr><td><code>-RefreshInterval</code></td><td>Time in seconds between updates. Minimum is 1 second.</td></tr></tbody></table><h2 id="performance-considerations" tabindex="-1">Performance Considerations <a class="header-anchor" href="#performance-considerations" aria-label="Permalink to &quot;Performance Considerations&quot;">​</a></h2><ul><li><strong>Background Execution</strong>: Refresh scripts run in separate runspaces, so they don&#39;t block the UI.</li><li><strong>Resource Usage</strong>: Frequent refreshes (e.g., every 1 second) on complex scripts (like querying remote WMI) can increase CPU/Memory usage.</li><li><strong>Error Handling</strong>: If a refresh script fails, the card will display the last known good value or an error indicator if configured.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Use <code>Get-CimInstance</code> instead of <code>Get-WmiObject</code> for better performance and modern compatibility in your refresh scripts.</p></div><p>Next: <a href="./categories.html">Category Filtering</a></p>',16)])])}const g=i(h,[["render",r]]);export{c as __pageData,g as default};
