import{_ as o,c as t,o as a,ae as r}from"./chunks/framework.CM88uqJ3.js";const m=JSON.parse('{"title":"Platform Architecture","description":"","frontmatter":{},"headers":[],"relativePath":"platform/architecture.md","filePath":"platform/architecture.md"}'),i={name:"platform/architecture.md"};function s(n,e,l,d,c,h){return a(),t("div",null,[...e[0]||(e[0]=[r('<h1 id="platform-architecture" tabindex="-1">Platform Architecture <a class="header-anchor" href="#platform-architecture" aria-label="Permalink to &quot;Platform Architecture&quot;">​</a></h1><p>PoshUI uses a hybrid architecture that combines the flexibility of PowerShell with the rendering power of the Windows Presentation Foundation (WPF).</p><h2 id="the-hybrid-approach" tabindex="-1">The Hybrid Approach <a class="header-anchor" href="#the-hybrid-approach" aria-label="Permalink to &quot;The Hybrid Approach&quot;">​</a></h2><p>The framework is split into two distinct layers:</p><ol><li><strong>PowerShell Layer (The Definition)</strong>: A set of native PowerShell modules (<code>PoshUI.Wizard</code>, <code>PoshUI.Dashboard</code>, <code>PoshUI.Workflow</code>) that provide cmdlets for building UI definitions. These modules manage the state and logic of your application.</li><li><strong>C# Layer (The Engine)</strong>: A standalone WPF executable (<code>PoshUI.exe</code>) built on .NET Framework 4.8. This engine is responsible for rendering the Windows 11-style UI, handling animations, and providing the execution console.</li></ol><h2 id="communication-bridge" tabindex="-1">Communication Bridge <a class="header-anchor" href="#communication-bridge" aria-label="Permalink to &quot;Communication Bridge&quot;">​</a></h2><p>PoshUI uses a &quot;mixed communication&quot; model to pass data between PowerShell and the WPF engine.</p><h3 id="dashboard-workflow-json-based" tabindex="-1">Dashboard &amp; Workflow (JSON-Based) <a class="header-anchor" href="#dashboard-workflow-json-based" aria-label="Permalink to &quot;Dashboard &amp; Workflow (JSON-Based)&quot;">​</a></h3><p>The Dashboard and Workflow modules use <strong>JSON serialization</strong>.</p><ul><li>PowerShell converts the <code>UIDefinition</code> object into a structured JSON file.</li><li>The C# engine loads this JSON using <code>JsonDefinitionLoader.cs</code>.</li><li>This method is faster and supports complex nested objects like chart data and workflow tasks.</li></ul><h3 id="wizard-ast-based" tabindex="-1">Wizard (AST-Based) <a class="header-anchor" href="#wizard-ast-based" aria-label="Permalink to &quot;Wizard (AST-Based)&quot;">​</a></h3><p>The Wizard module uses <strong>Abstract Syntax Tree (AST) parsing</strong> for maximum backward compatibility.</p><ul><li>PowerShell generates a temporary <code>.ps1</code> file containing a <code>param()</code> block with custom attributes (e.g., <code>[WizardTextBox()]</code>).</li><li>The C# engine parses this script using <code>ReflectionService.cs</code>.</li><li>This allows existing parameter-based scripts to be converted to PoshUI wizards with minimal changes.</li></ul><h2 id="execution-flow" tabindex="-1">Execution Flow <a class="header-anchor" href="#execution-flow" aria-label="Permalink to &quot;Execution Flow&quot;">​</a></h2><ol><li><strong>Import</strong>: You import one of the PoshUI modules.</li><li><strong>Define</strong>: You use cmdlets like <code>Add-UIStep</code> and <code>Add-UITextBox</code> to build your UI.</li><li><strong>Serialize</strong>: When you call <code>Show-PoshUI*</code>, the module serializes the definition to a secure temporary file.</li><li><strong>Launch</strong>: The module launches <code>PoshUI.exe</code>, passing the path to the temporary file.</li><li><strong>Render</strong>: The WPF engine parses the file and renders the professional interface.</li><li><strong>Execute</strong>: User interactions (like clicking &quot;Finish&quot;) trigger PowerShell execution or return data.</li><li><strong>Return</strong>: The engine writes results to a <code>.result.json</code> file, which the module parses and returns to your script.</li></ol><h2 id="security-isolation" tabindex="-1">Security &amp; Isolation <a class="header-anchor" href="#security-isolation" aria-label="Permalink to &quot;Security &amp; Isolation&quot;">​</a></h2><ul><li><strong>Secure Temp Files</strong>: All communication files are created with cryptographically random names and restrictive ACLs (accessible only by the current user).</li><li><strong>Process Isolation</strong>: The UI runs in a separate process from your main PowerShell session, ensuring that long-running tasks don&#39;t block your terminal.</li><li><strong>Memory Safety</strong>: Sensitive data like passwords (handled as <code>SecureString</code>) are cleared from memory immediately after use.</li></ul><p>Next: <a href="./module-structure.html">Module Structure</a></p>',18)])])}const p=o(i,[["render",s]]);export{m as __pageData,p as default};
