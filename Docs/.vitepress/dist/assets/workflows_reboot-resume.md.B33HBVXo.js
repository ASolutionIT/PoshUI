import{_ as i,c as a,o as e,ae as t}from"./chunks/framework.CDjunVez.js";const E=JSON.parse('{"title":"Reboot & Resume","description":"","frontmatter":{},"headers":[],"relativePath":"workflows/reboot-resume.md","filePath":"workflows/reboot-resume.md"}'),n={name:"workflows/reboot-resume.md"};function l(h,s,k,p,r,o){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="reboot-resume" tabindex="-1">Reboot &amp; Resume <a class="header-anchor" href="#reboot-resume" aria-label="Permalink to &quot;Reboot &amp; Resume&quot;">​</a></h1><p>One of the most powerful features of PoshUI Workflows is the ability to handle system reboots and automatically resume execution.</p><h2 id="key-concept" tabindex="-1">Key Concept <a class="header-anchor" href="#key-concept" aria-label="Permalink to &quot;Key Concept&quot;">​</a></h2><p><code>RequestReboot()</code> is <strong>not</strong> a system reboot command. It&#39;s a <strong>workflow control signal</strong> that:</p><ol><li>Saves the current workflow state to disk</li><li>Stops the current task execution</li><li>Shows the user a reboot dialog</li><li>Allows the workflow to resume from the next task after reboot</li></ol><h2 id="requesting-a-reboot" tabindex="-1">Requesting a Reboot <a class="header-anchor" href="#requesting-a-reboot" aria-label="Permalink to &quot;Requesting a Reboot&quot;">​</a></h2><p>From within any workflow task, call <code>$PoshUIWorkflow.RequestReboot()</code>:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;UpdateKernel&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Updating Kernel&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Kernel update applied. System needs to restart.&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Request a reboot with a reason</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $PoshUIWorkflow.RequestReboot(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Kernel Update Applied&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Code after RequestReboot() will execute after resume</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;System rebooted successfully&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="what-happens" tabindex="-1">What Happens <a class="header-anchor" href="#what-happens" aria-label="Permalink to &quot;What Happens&quot;">​</a></h3><ol><li><strong>State Saved</strong>: Workflow state is automatically saved to <code>%LOCALAPPDATA%\\PoshUI\\PoshUI_Workflow_State.json</code></li><li><strong>Task Marked Complete</strong>: Current task is marked as completed</li><li><strong>Dialog Shown</strong>: User sees reboot options (&quot;Reboot Now&quot;, &quot;Reboot Later&quot;, &quot;Simulate&quot;)</li><li><strong>Execution Stops</strong>: Remaining tasks pause until after reboot</li><li><strong>Script Closes</strong>: The PoshUI window closes</li></ol><h2 id="resuming-after-reboot" tabindex="-1">Resuming After Reboot <a class="header-anchor" href="#resuming-after-reboot" aria-label="Permalink to &quot;Resuming After Reboot&quot;">​</a></h2><p>When the system restarts and the user runs the script again, it automatically detects the saved state and resumes.</p><h3 id="basic-resume-pattern" tabindex="-1">Basic Resume Pattern <a class="header-anchor" href="#basic-resume-pattern" aria-label="Permalink to &quot;Basic Resume Pattern&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Import-Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PoshUI.Workflow</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. Initialize workflow (must match the original)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">New-PoshUIWorkflow</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;System Setup&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. Check for saved state</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Test-UIWorkflowState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. Load and resume from saved state</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Resume-UIWorkflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 4. Redefine the SAME tasks (Resume-UIWorkflow marks completed ones to skip)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase 1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock { ..</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase 2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock { ..</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 5. Show the UI (skips wizard, continues from next pending task)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Show-PoshUIWorkflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # First run: normal workflow setup</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIStep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Config&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Configuration&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Order </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UITextBox</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Config&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ServerName&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Label </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Server Name&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIStep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Order </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type Workflow</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase 1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock { ..</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Phase 2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock { ..</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Show-PoshUIWorkflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="reboot-resume-checklist" tabindex="-1">Reboot &amp; Resume Checklist <a class="header-anchor" href="#reboot-resume-checklist" aria-label="Permalink to &quot;Reboot &amp; Resume Checklist&quot;">​</a></h2><p>Use this checklist when implementing reboot/resume workflows:</p><ul><li>[ ] <strong>Define workflow structure</strong> - Create all steps and tasks before first run</li><li>[ ] <strong>Call <code>Test-UIWorkflowState</code></strong> - Check for saved state at script start</li><li>[ ] <strong>Call <code>Resume-UIWorkflow</code></strong> - Load saved state if it exists</li><li>[ ] <strong>Redefine all tasks</strong> - Must define the same tasks in the same order</li><li>[ ] <strong>Use <code>RequestReboot()</code></strong> - Call from task when reboot is needed</li><li>[ ] <strong>Test first run</strong> - Verify wizard and first tasks work</li><li>[ ] <strong>Test resume</strong> - Simulate reboot and verify resume works</li><li>[ ] <strong>Verify cleanup</strong> - Confirm state file is deleted after completion</li><li>[ ] <strong>Test cancellation</strong> - Verify state file cleanup if user cancels</li></ul><h2 id="state-file-management" tabindex="-1">State File Management <a class="header-anchor" href="#state-file-management" aria-label="Permalink to &quot;State File Management&quot;">​</a></h2><h3 id="location" tabindex="-1">Location <a class="header-anchor" href="#location" aria-label="Permalink to &quot;Location&quot;">​</a></h3><p><code>%LOCALAPPDATA%\\PoshUI\\PoshUI_Workflow_State.json</code></p><h3 id="contents" tabindex="-1">Contents <a class="header-anchor" href="#contents" aria-label="Permalink to &quot;Contents&quot;">​</a></h3><ul><li>Current task index (which task to resume from)</li><li>All wizard input values</li><li>Completed task output and progress</li><li>Log file path (for continuity)</li><li>Timestamp and computer info</li></ul><h3 id="automatic-cleanup" tabindex="-1">Automatic Cleanup <a class="header-anchor" href="#automatic-cleanup" aria-label="Permalink to &quot;Automatic Cleanup&quot;">​</a></h3><p>The state file is <strong>automatically deleted</strong> when:</p><ul><li>Workflow completes successfully</li><li>User cancels the workflow</li></ul><h3 id="manual-cleanup" tabindex="-1">Manual Cleanup <a class="header-anchor" href="#manual-cleanup" aria-label="Permalink to &quot;Manual Cleanup&quot;">​</a></h3><p>If you need to manually clear the state (for testing or recovery):</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Clear-UIWorkflowState</span></span></code></pre></div><h2 id="state-persistence-details" tabindex="-1">State Persistence Details <a class="header-anchor" href="#state-persistence-details" aria-label="Permalink to &quot;State Persistence Details&quot;">​</a></h2><h3 id="what-is-saved" tabindex="-1">What is Saved <a class="header-anchor" href="#what-is-saved" aria-label="Permalink to &quot;What is Saved&quot;">​</a></h3><ul><li>✅ Wizard input values</li><li>✅ Completed task status and output</li><li>✅ Log file path</li><li>✅ Current task index</li></ul><h3 id="what-is-not-saved" tabindex="-1">What is NOT Saved <a class="header-anchor" href="#what-is-not-saved" aria-label="Permalink to &quot;What is NOT Saved&quot;">​</a></h3><ul><li>❌ Variables created during task execution</li><li>❌ External file changes</li><li>❌ Registry modifications</li><li>❌ Installed software</li></ul><p><strong>Important</strong>: Your tasks should be <strong>idempotent</strong> (safe to run multiple times). For example:</p><ul><li>Check if software is already installed before installing</li><li>Check if a service is already running before starting it</li><li>Use <code>-Force</code> flags cautiously on resume</li></ul><h3 id="example-idempotent-task" tabindex="-1">Example: Idempotent Task <a class="header-anchor" href="#example-idempotent-task" aria-label="Permalink to &quot;Example: Idempotent Task&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;InstallFeature&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Install Windows Feature&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $feature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Get-WindowsFeature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Web-Server&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($feature.Installed) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Feature already installed&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Installing feature...&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Install-WindowsFeature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Web-Server&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Feature installed&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><h2 id="auto-launch-after-reboot-optional" tabindex="-1">Auto-Launch After Reboot (Optional) <a class="header-anchor" href="#auto-launch-after-reboot-optional" aria-label="Permalink to &quot;Auto-Launch After Reboot (Optional)&quot;">​</a></h2><p>For the best user experience, add your script to the Windows RunOnce registry key so it launches automatically after reboot:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$scriptPath </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $PSCommandPath</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$regPath </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Add script to RunOnce (runs once at next logon)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">New-ItemProperty</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Path $regPath </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;PoshUIWorkflow&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Value </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;powershell.exe -NoProfile -ExecutionPolicy Bypass -File </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$scriptPath</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Force </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Out-Null</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Then request reboot</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PoshUIWorkflow.RequestReboot(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;System reboot required&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="state-file-not-found-after-reboot" tabindex="-1">State file not found after reboot <a class="header-anchor" href="#state-file-not-found-after-reboot" aria-label="Permalink to &quot;State file not found after reboot&quot;">​</a></h3><ul><li>Verify the script is running as the same user</li><li>Check that <code>%LOCALAPPDATA%</code> path is accessible</li><li>Confirm <code>Test-UIWorkflowState</code> is called before <code>Resume-UIWorkflow</code></li></ul><h3 id="tasks-running-again-after-resume" tabindex="-1">Tasks running again after resume <a class="header-anchor" href="#tasks-running-again-after-resume" aria-label="Permalink to &quot;Tasks running again after resume&quot;">​</a></h3><ul><li>Ensure you call <code>Resume-UIWorkflow</code> before defining tasks</li><li>Verify task names match exactly (case-sensitive)</li><li>Check that task order hasn&#39;t changed</li></ul><h3 id="state-file-not-deleted-after-completion" tabindex="-1">State file not deleted after completion <a class="header-anchor" href="#state-file-not-deleted-after-completion" aria-label="Permalink to &quot;State file not deleted after completion&quot;">​</a></h3><ul><li>Verify workflow completed without errors</li><li>Check that all tasks have status &quot;Completed&quot;</li><li>Manually clear with <code>Clear-UIWorkflowState</code> if needed</li></ul><p>Next: <a href="./logging.html">Workflow Logging</a> | <a href="./tasks.html">Working with Tasks</a></p>`,48)])])}const g=i(n,[["render",l]]);export{E as __pageData,g as default};
