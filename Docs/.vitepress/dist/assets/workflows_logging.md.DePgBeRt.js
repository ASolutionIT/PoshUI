import{_ as i,c as a,o as t,ae as e}from"./chunks/framework.CM88uqJ3.js";const d=JSON.parse('{"title":"Workflow Logging","description":"","frontmatter":{},"headers":[],"relativePath":"workflows/logging.md","filePath":"workflows/logging.md"}'),n={name:"workflows/logging.md"};function l(o,s,h,r,p,k){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="workflow-logging" tabindex="-1">Workflow Logging <a class="header-anchor" href="#workflow-logging" aria-label="Permalink to &quot;Workflow Logging&quot;">​</a></h1><p>PoshUI Workflows feature a comprehensive logging system designed for enterprise troubleshooting. By default, every workflow execution generates a detailed log file in a CMTrace-compatible format.</p><h2 id="log-file-location" tabindex="-1">Log File Location <a class="header-anchor" href="#log-file-location" aria-label="Permalink to &quot;Log File Location&quot;">​</a></h2><p>By default, logs are stored in a <code>Logs</code> folder located in the same directory as your PowerShell script.</p><ul><li><strong>Default Path</strong>: <code>.\\Logs\\Workflow_Script_Name_yyyy-MM-dd_HHmmss.log</code></li></ul><p>You can customize the log directory using the <code>-LogPath</code> parameter when calling <code>New-PoshUIWorkflow</code>.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">New-PoshUIWorkflow</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;System Setup&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogPath </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C:\\IT\\Logs&#39;</span></span></code></pre></div><h2 id="logging-features" tabindex="-1">Logging Features <a class="header-anchor" href="#logging-features" aria-label="Permalink to &quot;Logging Features&quot;">​</a></h2><h3 id="cmtrace-compatibility" tabindex="-1">CMTrace Compatibility <a class="header-anchor" href="#cmtrace-compatibility" aria-label="Permalink to &quot;CMTrace Compatibility&quot;">​</a></h3><p>The logs use the standard CMTrace format, allowing you to use Microsoft&#39;s log viewer to easily filter by component, level, and timestamp.</p><h3 id="automatic-capture" tabindex="-1">Automatic Capture <a class="header-anchor" href="#automatic-capture" aria-label="Permalink to &quot;Automatic Capture&quot;">​</a></h3><p>The following events are automatically logged without any extra code:</p><ul><li><strong>Task Transitions</strong>: Start and end times for every task.</li><li><strong>Wizard Data</strong>: A summary of values collected during the wizard phase.</li><li><strong>Errors</strong>: Full exception details if a task fails.</li><li><strong>Console Output</strong>: Anything written to the UI console is also captured in the log.</li></ul><h2 id="writing-custom-log-entries" tabindex="-1">Writing Custom Log Entries <a class="header-anchor" href="#writing-custom-log-entries" aria-label="Permalink to &quot;Writing Custom Log Entries&quot;">​</a></h2><p>You can write your own messages to the log file from within a task using the <code>$PoshUIWorkflow</code> context object.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Verify&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Verifying State&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # This writes to both the UI console and the log file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Checking service status...&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Information&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # You can specify levels: Information, Warning, Error</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Low disk space detected!&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Warning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="log-continuity-during-resumes" tabindex="-1">Log Continuity during Resumes <a class="header-anchor" href="#log-continuity-during-resumes" aria-label="Permalink to &quot;Log Continuity during Resumes&quot;">​</a></h2><p>When a workflow resumes after a reboot, PoshUI automatically detects the previous log file and continues writing to it. This provides a single, contiguous record of the entire process from start to finish across multiple sessions.</p><h2 id="log-levels" tabindex="-1">Log Levels <a class="header-anchor" href="#log-levels" aria-label="Permalink to &quot;Log Levels&quot;">​</a></h2><p>When writing to the log, use appropriate levels to help with troubleshooting:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Informational - normal operation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Starting deployment...&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Warning - something unexpected but recoverable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Service already running, skipping start&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;WARN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Error - something failed</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to connect to server&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="viewing-logs" tabindex="-1">Viewing Logs <a class="header-anchor" href="#viewing-logs" aria-label="Permalink to &quot;Viewing Logs&quot;">​</a></h2><p>Logs are stored in CMTrace format, which can be viewed with:</p><ul><li><strong>CMTrace.exe</strong> - Microsoft&#39;s log viewer (included with SCCM/MECM)</li><li><strong>Trace32.exe</strong> - Alternative log viewer</li><li><strong>Any text editor</strong> - Logs are plain text</li></ul><p>The CMTrace format makes it easy to filter by:</p><ul><li>Component</li><li>Level (Info, Warning, Error)</li><li>Timestamp</li><li>Thread ID</li></ul><h2 id="best-practices-for-logging" tabindex="-1">Best Practices for Logging <a class="header-anchor" href="#best-practices-for-logging" aria-label="Permalink to &quot;Best Practices for Logging&quot;">​</a></h2><ol><li><strong>Log important state changes</strong> - When tasks start/complete</li><li><strong>Log errors with context</strong> - Include what was being done when error occurred</li><li><strong>Use appropriate levels</strong> - INFO for normal, WARN for issues, ERROR for failures</li><li><strong>Be concise</strong> - Keep messages short but descriptive</li><li><strong>Include values</strong> - Log relevant variable values for debugging</li></ol><h3 id="example-good-logging" tabindex="-1">Example: Good Logging <a class="header-anchor" href="#example-good-logging" aria-label="Permalink to &quot;Example: Good Logging&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-UIWorkflowTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Step </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Execution&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Deploy&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Title </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Deploying Application&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScriptBlock {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Starting deployment to </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ServerName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Invoke-Deployment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Server $ServerName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Deployment succeeded: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$result.Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            $PoshUIWorkflow.WriteOutput(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Deployment failed: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.Exception.Message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            throw</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>Next: <a href="./tasks.html">Working with Tasks</a> | <a href="./reboot-resume.html">Reboot &amp; Resume</a></p>`,31)])])}const c=i(n,[["render",l]]);export{d as __pageData,c as default};
