import{_ as o,c as i,o as t,ae as a}from"./chunks/framework.CDjunVez.js";const u=JSON.parse('{"title":"Debugging PoshUI","description":"","frontmatter":{},"headers":[],"relativePath":"development/debugging.md","filePath":"development/debugging.md"}'),s={name:"development/debugging.md"};function n(r,e,l,d,h,g){return t(),i("div",null,[...e[0]||(e[0]=[a('<h1 id="debugging-poshui" tabindex="-1">Debugging PoshUI <a class="header-anchor" href="#debugging-poshui" aria-label="Permalink to &quot;Debugging PoshUI&quot;">​</a></h1><p>Debugging a hybrid application like PoshUI requires looking at both the PowerShell modules and the C# execution engine. This guide provides strategies for identifying and resolving issues in both layers.</p><h2 id="debugging-powershell-modules" tabindex="-1">Debugging PowerShell Modules <a class="header-anchor" href="#debugging-powershell-modules" aria-label="Permalink to &quot;Debugging PowerShell Modules&quot;">​</a></h2><h3 id="verbose-output" tabindex="-1">Verbose Output <a class="header-anchor" href="#verbose-output" aria-label="Permalink to &quot;Verbose Output&quot;">​</a></h3><p>Most PoshUI cmdlets support the <code>-Verbose</code> switch. This is the first step in troubleshooting module-level logic, such as serialization or state management.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Show-PoshUIWizard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Verbose</span></span></code></pre></div><h3 id="script-scoped-state" tabindex="-1">Script-Scoped State <a class="header-anchor" href="#script-scoped-state" aria-label="Permalink to &quot;Script-Scoped State&quot;">​</a></h3><p>You can inspect the current state of the UI definition by looking at the script-scoped variables in the module:</p><ul><li><strong>Wizard</strong>: <code>$script:CurrentWizard</code></li><li><strong>Workflow</strong>: <code>$script:CurrentWorkflow</code></li></ul><p>Since these are script-scoped, you may need to use <code>Get-Variable</code> with the module&#39;s scope if you are debugging from an external terminal.</p><hr><h2 id="debugging-the-c-engine-poshui-exe" tabindex="-1">Debugging the C# Engine (PoshUI.exe) <a class="header-anchor" href="#debugging-the-c-engine-poshui-exe" aria-label="Permalink to &quot;Debugging the C# Engine (PoshUI.exe)&quot;">​</a></h2><h3 id="appdebug-mode" tabindex="-1">AppDebug Mode <a class="header-anchor" href="#appdebug-mode" aria-label="Permalink to &quot;AppDebug Mode&quot;">​</a></h3><p>When calling <code>Show-PoshUIWizard</code> or <code>Show-PoshUIWorkflow</code>, you can use the <code>-AppDebug</code> switch. This tells the C# engine to enable internal debugging features, such as more detailed error dialogs and logging.</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Show-PoshUIWizard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AppDebug</span></span></code></pre></div><h3 id="visual-studio-debugging" tabindex="-1">Visual Studio Debugging <a class="header-anchor" href="#visual-studio-debugging" aria-label="Permalink to &quot;Visual Studio Debugging&quot;">​</a></h3><p>If you have the source code, you can debug the UI engine directly:</p><ol><li>Open <code>UIFramework.sln</code> in Visual Studio.</li><li>Set the <code>Launcher</code> project as the StartUp project.</li><li>In the project properties, go to the <strong>Debug</strong> tab.</li><li>Set <strong>Application arguments</strong> to point to a valid PoshUI temporary file (e.g., <code>C:\\Users\\...\\AppData\\Local\\Temp\\PoshUI\\debug.json</code>).</li><li>Press <strong>F5</strong> to start debugging.</li></ol><hr><h2 id="analyzing-logs" tabindex="-1">Analyzing Logs <a class="header-anchor" href="#analyzing-logs" aria-label="Permalink to &quot;Analyzing Logs&quot;">​</a></h2><p>PoshUI&#39;s CMTrace-compatible logs are the most valuable resource for troubleshooting in production.</p><ol><li>Navigate to the <code>Logs</code> folder relative to your script.</li><li>Open the most recent <code>.log</code> file using <strong>CMTrace.exe</strong>.</li><li>Look for entries highlighted in <strong>Red (Error)</strong> or <strong>Yellow (Warning)</strong>.</li></ol><p>Common log indicators:</p><ul><li><strong>Serialization Error</strong>: Indicates a problem converting your PowerShell definition to JSON.</li><li><strong>AST Parsing Error</strong>: Indicates a syntax issue in your <code>param()</code> block or custom attributes.</li><li><strong>WPF Binding Error</strong>: Usually indicates a mismatch between a control&#39;s <code>Name</code> and its internal ViewModel property.</li></ul><hr><h2 id="common-issues-solutions" tabindex="-1">Common Issues &amp; Solutions <a class="header-anchor" href="#common-issues-solutions" aria-label="Permalink to &quot;Common Issues &amp; Solutions&quot;">​</a></h2><h3 id="ui-fails-to-launch" tabindex="-1">UI Fails to Launch <a class="header-anchor" href="#ui-fails-to-launch" aria-label="Permalink to &quot;UI Fails to Launch&quot;">​</a></h3><ul><li><strong>Check</strong>: Is <code>PoshUI.exe</code> blocked by Windows? Right-click the file and select &quot;Unblock&quot;.</li><li><strong>Check</strong>: Is the <code>.NET Framework 4.8</code> installed?</li><li><strong>Solution</strong>: Run your script with <code>-Verbose</code> to see exactly which path the module is using to launch the EXE.</li></ul><h3 id="dynamic-dropdown-is-empty" tabindex="-1">Dynamic Dropdown is Empty <a class="header-anchor" href="#dynamic-dropdown-is-empty" aria-label="Permalink to &quot;Dynamic Dropdown is Empty&quot;">​</a></h3><ul><li><strong>Check</strong>: Does the <code>-ScriptBlock</code> return an array of strings?</li><li><strong>Check</strong>: Did you include the <code>-DependsOn</code> parameter?</li><li><strong>Solution</strong>: Test your script block independently in a standard PowerShell terminal to ensure it returns the expected data.</li></ul><h3 id="password-validation-fails" tabindex="-1">Password Validation Fails <a class="header-anchor" href="#password-validation-fails" aria-label="Permalink to &quot;Password Validation Fails&quot;">​</a></h3><ul><li><strong>Check</strong>: Are you using <code>-ValidationPattern</code>?</li><li><strong>Check</strong>: Does the regex work against the plaintext version of your test password?</li><li><strong>Solution</strong>: Remember that password validation happens inside the C# engine for security.</li></ul><p>Next: <a href="./contributing.html">Contributing</a></p>',33)])])}const p=o(s,[["render",n]]);export{u as __pageData,p as default};
